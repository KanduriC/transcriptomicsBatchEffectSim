batch_difference_threshold = 3,
n_true_diff_genes = 50,
n_true_upreg_genes = 25,
max_baseline_log2FC_between_groups = 0.25,
avg_log2FC_between_groups = 1,
train_split_prop = 0.70,
batch_effects_exist = TRUE
)
baseline_exprs_mat <- generate_baseline_exprs_matrix(
n_genes=sim_params$approx_n_genes,
n_examples=sim_params$n_examples)
batch_induced_exprs_mat <- induce_batch_differences(baseline_exprs_mat=baseline_exprs_mat,
sim_params=sim_params)
post_stats <- compute_groupwise_stats(batch_induced_exprs_mat, sim_params)
mean(abs(post_stats$batch_fc))
sim_params <-
list(
approx_n_genes = 5000,
n_examples = 60,
batch1_indices = 1:30,
batch2_indices = 31:60,
batch1_group1_indices = 1:15,
batch1_group2_indices = 16:30,
batch2_group1_indices = 31:45,
batch2_group2_indices = 46:60,
group1_indices = c(1:15, 31:45),
group2_indices = c(16:30, 46:60),
batch_difference_threshold = 1,
n_true_diff_genes = 50,
n_true_upreg_genes = 25,
max_baseline_log2FC_between_groups = 0.25,
avg_log2FC_between_groups = 1,
train_split_prop = 0.70,
batch_effects_exist = TRUE
)
baseline_exprs_mat <- generate_baseline_exprs_matrix(
n_genes=sim_params$approx_n_genes,
n_examples=sim_params$n_examples)
batch_induced_exprs_mat <- induce_batch_differences(baseline_exprs_mat=baseline_exprs_mat,
sim_params=sim_params)
post_stats <- compute_groupwise_stats(batch_induced_exprs_mat, sim_params)
mean(abs(post_stats$batch_fc))
sim_params <-
list(
approx_n_genes = 5000,
n_examples = 60,
batch1_indices = 1:30,
batch2_indices = 31:60,
batch1_group1_indices = 1:15,
batch1_group2_indices = 16:30,
batch2_group1_indices = 31:45,
batch2_group2_indices = 46:60,
group1_indices = c(1:15, 31:45),
group2_indices = c(16:30, 46:60),
batch_difference_threshold = 1,
n_true_diff_genes = 50,
n_true_upreg_genes = 25,
max_baseline_log2FC_between_groups = 0.25,
avg_log2FC_between_groups = 2,
train_split_prop = 0.70,
batch_effects_exist = TRUE
)
baseline_exprs_mat <- generate_baseline_exprs_matrix(
n_genes=sim_params$approx_n_genes,
n_examples=sim_params$n_examples)
batch_induced_exprs_mat <- induce_batch_differences(baseline_exprs_mat=baseline_exprs_mat,
sim_params=sim_params)
post_stats <- compute_groupwise_stats(batch_induced_exprs_mat, sim_params)
mean(abs(post_stats$batch_fc))
sim_params <-
list(
approx_n_genes = 5000,
n_examples = 60,
batch1_indices = 1:30,
batch2_indices = 31:60,
batch1_group1_indices = 1:15,
batch1_group2_indices = 16:30,
batch2_group1_indices = 31:45,
batch2_group2_indices = 46:60,
group1_indices = c(1:15, 31:45),
group2_indices = c(16:30, 46:60),
batch_difference_threshold = 2,
n_true_diff_genes = 50,
n_true_upreg_genes = 25,
max_baseline_log2FC_between_groups = 0.25,
avg_log2FC_between_groups = 2,
train_split_prop = 0.70,
batch_effects_exist = TRUE
)
baseline_exprs_mat <- generate_baseline_exprs_matrix(
n_genes=sim_params$approx_n_genes,
n_examples=sim_params$n_examples)
batch_induced_exprs_mat <- induce_batch_differences(baseline_exprs_mat=baseline_exprs_mat,
sim_params=sim_params)
post_stats <- compute_groupwise_stats(batch_induced_exprs_mat, sim_params)
mean(abs(post_stats$batch_fc))
devtools::load_all()
sim_params <-
list(
approx_n_genes = 5000,
n_examples = 60,
batch1_indices = 1:30,
batch2_indices = 31:60,
batch1_group1_indices = 1:15,
batch1_group2_indices = 16:30,
batch2_group1_indices = 31:45,
batch2_group2_indices = 46:60,
group1_indices = c(1:15, 31:45),
group2_indices = c(16:30, 46:60),
batch_difference_threshold = 4,
n_true_diff_genes = 50,
n_true_upreg_genes = 25,
max_baseline_log2FC_between_groups = 0.25,
avg_log2FC_between_groups = 2,
train_split_prop = 0.70,
batch_effects_exist = TRUE
)
baseline_exprs_mat <- generate_baseline_exprs_matrix(
n_genes=sim_params$approx_n_genes,
n_examples=sim_params$n_examples)
batch_induced_exprs_mat <- induce_batch_differences(baseline_exprs_mat=baseline_exprs_mat,
sim_params=sim_params)
post_stats <- compute_groupwise_stats(batch_induced_exprs_mat, sim_params)
mean(abs(post_stats$batch_fc))
sim_params <-
list(
approx_n_genes = 500,
n_examples = 60,
batch1_indices = 1:30,
batch2_indices = 31:60,
batch1_group1_indices = 1:15,
batch1_group2_indices = 16:30,
batch2_group1_indices = 31:45,
batch2_group2_indices = 46:60,
group1_indices = c(1:15, 31:45),
group2_indices = c(16:30, 46:60),
batch_difference_threshold = 2,
n_true_diff_genes = 50,
n_true_upreg_genes = 25,
max_baseline_log2FC_between_groups = 0.25,
avg_log2FC_between_groups = 2,
train_split_prop = 0.70,
batch_effects_exist = TRUE
)
baseline_exprs_mat <- generate_baseline_exprs_matrix(
n_genes=sim_params$approx_n_genes,
n_examples=sim_params$n_examples)
batch_induced_exprs_mat <- induce_batch_differences(baseline_exprs_mat=baseline_exprs_mat,
sim_params=sim_params)
pheatmap::pheatmap(batch_induced_exprs_mat, scale = "row", cluster_rows = F, cluster_cols = F, color = colorRampPalette(rev(brewer.pal(n = 7, name =
"Blues")))(100))
devtools::load_all()
sim_params <-
list(
approx_n_genes = 500,
n_examples = 60,
batch1_indices = 1:30,
batch2_indices = 31:60,
batch1_group1_indices = 1:15,
batch1_group2_indices = 16:30,
batch2_group1_indices = 31:45,
batch2_group2_indices = 46:60,
group1_indices = c(1:15, 31:45),
group2_indices = c(16:30, 46:60),
batch_difference_threshold = 2,
n_true_diff_genes = 50,
n_true_upreg_genes = 25,
max_baseline_log2FC_between_groups = 0.25,
avg_log2FC_between_groups = 2,
train_split_prop = 0.70,
batch_effects_exist = TRUE
)
baseline_exprs_mat <- generate_baseline_exprs_matrix(
n_genes=sim_params$approx_n_genes,
n_examples=sim_params$n_examples)
batch_induced_exprs_mat <- induce_batch_differences(baseline_exprs_mat=baseline_exprs_mat,
sim_params=sim_params)
# group_means_filt <- filter_genes_based_on_sim_params(
#   simulated_datamat = batch_induced_exprs_mat,
#   sim_params=sim_params,
#   batch_effects_exist = TRUE)
group_means_filt <- get_descriptive_stats(simulated_datamat = batch_induced_exprs_mat,
sim_params=sim_params)
View(group_means_filt)
View(group_means_filt)
simulated_datamat=batch_induced_exprs_mat
batch_simulated_datamat=batch_induced_exprs_mat
batch_simulated_datamat_filt <-
batch_simulated_datamat[rownames(group_means_filt),]
dim(batch_simulated_datamat_filt)
diff_exp_indices <-
sample(1:nrow(batch_simulated_datamat),
sim_params$n_true_diff_genes,
replace = F)
g1_up_indices <- diff_exp_indices[1:sim_params$n_true_upreg_genes]
g2_up_indices <-
diff_exp_indices[(sim_params$n_true_upreg_genes + 1):sim_params$n_true_diff_genes]
View(group_means_filt)
fold_change <- sim_params$avg_log2FC_between_groups + 0.25
sim_params <-
list(
approx_n_genes = 500,
n_examples = 60,
batch1_indices = 1:30,
batch2_indices = 31:60,
batch1_group1_indices = 1:15,
batch1_group2_indices = 16:30,
batch2_group1_indices = 31:45,
batch2_group2_indices = 46:60,
group1_indices = c(1:15, 31:45),
group2_indices = c(16:30, 46:60),
batch_difference_threshold = 2,
n_true_diff_genes = 50,
n_true_upreg_genes = 25,
max_baseline_log2FC_between_groups = 0.25,
avg_log2FC_between_groups = 10,
train_split_prop = 0.70,
batch_effects_exist = TRUE
)
group_means_filt[g1_up_indices, ] <- group_means_filt[g1_up_indices, ] %>% dplyr::mutate(b1_g1_mean = b1_g1_mean + fold_change, b2_g1_mean = b2_g1_mean + fold_change)
group_means_filt[g2_up_indices, ] <- group_means_filt[g2_up_indices, ] %>% dplyr::mutate(b1_g2_mean = b1_g2_mean + fold_change, b2_g2_mean = b2_g2_mean + fold_change)
group1_mean_dispersion <-
group_means_filt[g1_up_indices, ] %>% dplyr::select(b1_g1_mean, b2_g1_mean, b1_dispersion, b2_dispersion)
group2_mean_dispersion <-
group_means_filt[g2_up_indices, ] %>% dplyr::select(b1_g2_mean, b2_g2_mean, b1_dispersion, b2_dispersion)
View(group1_mean_dispersion)
View(sim_params)
# group_means_filt <- filter_genes_based_on_sim_params(
#   simulated_datamat = batch_induced_exprs_mat,
#   sim_params=sim_params,
#   batch_effects_exist = TRUE)
group_means_filt <- get_descriptive_stats(simulated_datamat = batch_induced_exprs_mat,
sim_params=sim_params)
diff_exp_indices <-
sample(1:nrow(batch_simulated_datamat),
sim_params$n_true_diff_genes,
replace = F)
g1_up_indices <- diff_exp_indices[1:sim_params$n_true_upreg_genes]
g2_up_indices <-
diff_exp_indices[(sim_params$n_true_upreg_genes + 1):sim_params$n_true_diff_genes]
fold_change <- sim_params$avg_log2FC_between_groups + 0.25
group_means_filt[g1_up_indices, ] <- group_means_filt[g1_up_indices, ] %>% dplyr::mutate(b1_g1_mean = b1_g1_mean + fold_change, b2_g1_mean = b2_g1_mean + fold_change)
group_means_filt[g2_up_indices, ] <- group_means_filt[g2_up_indices, ] %>% dplyr::mutate(b1_g2_mean = b1_g2_mean + fold_change, b2_g2_mean = b2_g2_mean + fold_change)
group1_mean_dispersion <-
group_means_filt[g1_up_indices, ] %>% dplyr::select(b1_g1_mean, b2_g1_mean, b1_dispersion, b2_dispersion)
group2_mean_dispersion <-
group_means_filt[g2_up_indices, ] %>% dplyr::select(b1_g2_mean, b2_g2_mean, b1_dispersion, b2_dispersion)
group1_mean_dispersion <-
group_means_filt[g1_up_indices, ]
group2_mean_dispersion <-
group_means_filt[g2_up_indices, ]
View(group2_mean_dispersion)
mean_disp_loess <- fit_loess(mean_and_disperison=mean_and_disperison)
group_means_filt <- group_means_filt %>%
dplyr::mutate(
b1_g1_dispersion = predict(mean_disp_loess, 2 ^ b1_g1_mean),
b2_g1_dispersion = predict(mean_disp_loess, 2 ^ b2_g1_mean),
b1_g2_dispersion = predict(mean_disp_loess, 2 ^ b1_g2_mean),
b2_g2_dispersion = predict(mean_disp_loess, 2 ^ b2_g2_mean)
)
group1_mean_dispersion <-
group_means_filt[g1_up_indices, ] %>% dplyr::select(b1_g1_mean, b2_g1_mean, b1_g1_dispersion, b2_g1_dispersion)
group2_mean_dispersion <-
group_means_filt[g2_up_indices, ] %>% dplyr::select(b1_g2_mean, b2_g2_mean, b1_g2_dispersion, b2_g2_dispersion)
group1_mean_dispersion_list <-
split(group1_mean_dispersion, 1:nrow(group1_mean_dispersion))
group2_mean_dispersion_list <-
split(group2_mean_dispersion, 1:nrow(group2_mean_dispersion))
group1_mean_dispersion_list$`1`$b1_g1_mean
View(group1_mean_dispersion)
library(ggplot2)
View(mean_disp_loess)
ggplot(mean_and_disperison, aes(x=gene_means, y=dispersion))+geom_point()
ggplot(mean_and_disperison, aes(x=log2(gene_means), y=dispersion))+geom_point()
ggplot(mean_and_disperison, aes(x=log2(gene_means+0.01), y=dispersion))+geom_point()
ggplot(mean_and_disperison, aes(x=log10(gene_means+0.01), y=dispersion))+geom_point()
head(mean_and_disperison)
1/0.08
1/0.22
md <- mean_and_disperison
md <- md %>% dplyr::filter(gene_means>1)
md <- md %>% dplyr::filter(dispersion<10)
ggplot(md, aes(x=log10(gene_means+0.01), y=dispersion))+geom_point()
md <- md %>% dplyr::filter(dispersion<5)
ggplot(md, aes(x=log10(gene_means+0.01), y=dispersion))+geom_point()
predict(mean_disp_loess, 2 ^ seq(0,20))
predict(mean_disp_loess, 2 ^ seq(-10,20))
predict(mean_disp_loess, 2 ^ seq(-10,30))
1/0.22
1/1.26
2^20
a <- rnbinom(10, mu=32, size = 4.54)
mean(a)
sd(A)
sd(a)
a
b <- rnbinom(10, mu=32, size = 0.79)
mean(b)
sd(b)
b
a <- rnbinom(10, mu=32, size = 4.54)
b <- rnbinom(10, mu=32, size = 0.79)
sd(b)
sd(a)
group_means_filt$b1_g1_dispersion[which(!is.finite(group_means_filt$b1_g1_dispersion))] <-
mean(group_means_filt$b1_g1_dispersion, na.rm = T)
group_means_filt$b2_g1_dispersion[which(!is.finite(group_means_filt$b2_g1_dispersion))] <-
mean(group_means_filt$b2_g1_dispersion, na.rm = T)
group_means_filt$b1_g2_dispersion[which(!is.finite(group_means_filt$b1_g2_dispersion))] <-
mean(group_means_filt$b1_g2_dispersion, na.rm = T)
group_means_filt$b2_g2_dispersion[which(!is.finite(group_means_filt$b2_g2_dispersion))] <-
mean(group_means_filt$b2_g2_dispersion, na.rm = T)
group1_mean_dispersion <-
group_means_filt[g1_up_indices, ] %>% dplyr::select(b1_g1_mean, b2_g1_mean, b1_g1_dispersion, b2_g1_dispersion)
group2_mean_dispersion <-
group_means_filt[g2_up_indices, ] %>% dplyr::select(b1_g2_mean, b2_g2_mean, b1_g2_dispersion, b2_g2_dispersion)
group1_mean_dispersion_list <-
split(group1_mean_dispersion, 1:nrow(group1_mean_dispersion))
group2_mean_dispersion_list <-
split(group2_mean_dispersion, 1:nrow(group2_mean_dispersion))
View(group1_mean_dispersion)
View(group2_mean_dispersion)
b1_g1_upreg_counts  <-
t(sapply(group1_mean_dispersion_list, function(gene) {
rnbinom(
length(sim_params$batch1_group1_indices),
mu = 2 ^ (gene$b1_g1_mean),
size = 1 / gene$b1_g1_dispersion
)
}))
b2_g1_upreg_counts  <-
t(sapply(group1_mean_dispersion_list, function(gene) {
rnbinom(
length(sim_params$batch2_group1_indices),
mu = 2 ^ (gene$b2_g1_mean),
size = 1 / gene$b2_g1_dispersion
)
}))
b1_g2_upreg_counts  <-
t(sapply(group2_mean_dispersion_list, function(gene) {
rnbinom(
length(sim_params$batch1_group2_indices),
mu = 2 ^ (gene$b1_g2_mean),
size = 1 / gene$b1_g2_dispersion
)
}))
b2_g2_upreg_counts  <-
t(sapply(group2_mean_dispersion_list, function(gene) {
rnbinom(
length(sim_params$batch2_group2_indices),
mu = 2 ^ (gene$b2_g2_mean),
size = 1 / gene$b2_g2_dispersion
)
}))
batch_simulated_datamat[g1_up_indices, sim_params$batch1_group1_indices] <- b1_g1_upreg_counts
batch_simulated_datamat[g1_up_indices, sim_params$batch2_group1_indices] <- b2_g1_upreg_counts
batch_simulated_datamat[g2_up_indices, sim_params$batch1_group2_indices] <- b1_g2_upreg_counts
batch_simulated_datamat[g2_up_indices, sim_params$batch2_group2_indices] <- b2_g2_upreg_counts
devtools::load_all()
sim_params <-
list(
approx_n_genes = 500,
n_examples = 60,
batch1_indices = 1:30,
batch2_indices = 31:60,
batch1_group1_indices = 1:15,
batch1_group2_indices = 16:30,
batch2_group1_indices = 31:45,
batch2_group2_indices = 46:60,
group1_indices = c(1:15, 31:45),
group2_indices = c(16:30, 46:60),
batch_difference_threshold = 2,
n_true_diff_genes = 50,
n_true_upreg_genes = 25,
max_baseline_log2FC_between_groups = 0.25,
avg_log2FC_between_groups = 2,
train_split_prop = 0.70,
batch_effects_exist = TRUE
)
baseline_exprs_mat <- generate_baseline_exprs_matrix(
n_genes=sim_params$approx_n_genes,
n_examples=sim_params$n_examples)
batch_induced_exprs_mat <- induce_batch_differences(baseline_exprs_mat=baseline_exprs_mat,
sim_params=sim_params)
pheatmap::pheatmap(batch_induced_exprs_mat, scale = "row", cluster_rows = F, cluster_cols = F, color = colorRampPalette(rev(brewer.pal(n = 7, name =
"Blues")))(100))
# group_means_filt <- filter_genes_based_on_sim_params(
#   simulated_datamat = batch_induced_exprs_mat,
#   sim_params=sim_params,
#   batch_effects_exist = TRUE)
group_means_filt <- get_descriptive_stats(simulated_datamat = batch_induced_exprs_mat,
sim_params=sim_params)
sim_results <- induce_group_differences(simulated_datamat=batch_induced_exprs_mat,
group_means_filt=group_means_filt,
sim_params=sim_params,
batch_effects_exist=TRUE)
pheatmap::pheatmap(sim_results$batch_simulated_datamat_filt, scale = "row", cluster_rows = F, cluster_cols = F, color = colorRampPalette(rev(brewer.pal(n = 7, name =
"Blues")))(100))
pheatmap::pheatmap(sim_results$batch_simulated_datamat_filt, scale = "row", cluster_rows = T, cluster_cols = F, color = colorRampPalette(rev(brewer.pal(n = 7, name =
"Blues")))(100))
pheatmap::pheatmap(sim_results$batch_simulated_datamat_filt, scale = "row", cluster_rows = T, cluster_cols = F, color = colorRampPalette(rev(brewer.pal(n = 7, name =
"Blues")))(10))
data_objs_list <- prepare_metadata_and_exprsmat(
sim_params = sim_params,
simulated_datamat = sim_results$batch_simulated_datamat_filt,
batch_effects_exist=TRUE)
data_objs_list$group_means_filt <- group_means_filt
data_objs_list$post_sim_group_means <- compute_groupwise_stats(
simulated_datamat = data_objs_list$exprs_mat, sim_params = sim_params)
data_objs_list$diff_exp_indices <- sim_results$diff_exp_indices
summary(data_objs_list$post_sim_group_means$b1_groups_fc)
summary(abs(data_objs_list$post_sim_group_means$b1_groups_fc))
View(group_means_filt)
sim_results$diff_exp_indices
View(data_objs_list$post_sim_group_means[sim_results$diff_exp_indices])
View(data_objs_list$post_sim_group_means[sim_results$diff_exp_indices,])
plot(density(abs(data_objs_list$post_sim_group_means[sim_results$diff_exp_indices,]$b1_groups_fc)))
plot(density(abs(data_objs_list$post_sim_group_means[sim_results$diff_exp_indices,]$b1_groups_fc)))
View(group_means_filt)
pre_fc <- group_means_filt %>% dplyr::select(b1_groups_fc, b2_groups_fc)
View(pre_fc)
post_fc <- data_objs_list$post_sim_group_means %>% dplyr::select(b1_groups_fc, b2_groups_fc)
View(post_fc)
View(pre_fc)
View(post_fc)
View(pre_fc)
pre_fc$Gene <- rownames(pre_fc)
post_fc <- rownames(post_fc)
fc <- pre_fc %>% dplyr::left_join(post_fc)
post_fc$Gene <- rownames(post_fc)
post_fc <- data_objs_list$post_sim_group_means %>% dplyr::select(b1_groups_fc, b2_groups_fc)
post_fc$Gene <- rownames(post_fc)
fc <- pre_fc %>% dplyr::left_join(post_fc)
View(fc)
fc <- pre_fc %>% dplyr::left_join(post_fc, by="Gene")
View(fc)
length(which(fc$b1_groups_fc.x==fc$b1_groups_fc.y))
sim_params <-
list(
approx_n_genes = 500,
n_examples = 60,
group1_indices = 1:30,
group2_indices = 31:60,
n_true_diff_genes = 50,
n_true_upreg_genes = 25,
max_baseline_log2FC_between_groups = 0.25,
avg_log2FC_between_groups = 2,
train_split_prop = 0.70,
batch_effects_exist = FALSE
)
baseline_exprs_mat <- generate_baseline_exprs_matrix(n_genes=sim_params$approx_n_genes,
n_examples=sim_params$n_examples)
group_means_filt <- get_descriptive_stats(simulated_datamat = baseline_exprs_mat,
sim_params=sim_params)
View(group_means_filt)
summary(abs(group_means_filt$group_fc))
View(group_means_filt)
sim_params <-
list(
approx_n_genes = 500,
n_examples = 60,
group1_indices = 1:30,
group2_indices = 31:60,
n_true_diff_genes = 50,
n_true_upreg_genes = 25,
max_baseline_log2FC_between_groups = 0.25,
avg_log2FC_between_groups = 2,
train_split_prop = 0.70,
batch_effects_exist = FALSE
)
baseline_exprs_mat <- generate_baseline_exprs_matrix(n_genes=sim_params$approx_n_genes,
n_examples=sim_params$n_examples)
group_means_filt <- get_descriptive_stats(simulated_datamat = baseline_exprs_mat,
sim_params=sim_params)
devtools::load_all()
sim_results <- induce_group_differences(simulated_datamat=baseline_exprs_mat,
group_means_filt=group_means_filt,
sim_params=sim_params)
data_objs_list <- prepare_metadata_and_exprsmat(sim_params = sim_params,
simulated_datamat = sim_results$simulated_datamat_filt)
data_objs_list$group_means_filt <- group_means_filt
data_objs_list$post_sim_group_means <- compute_groupwise_stats(
simulated_datamat = data_objs_list$exprs_mat, sim_params = sim_params)
data_objs_list$diff_exp_indices <- sim_results$diff_exp_indices
group_stats <- compute_groupwise_stats(simulated_datamat=sim_results$simulated_datamat_filt,
sim_params=sim_params_without_batch)
group_stats <- compute_groupwise_stats(simulated_datamat=sim_results$simulated_datamat_filt,
sim_params=sim_params)
n_genes_not_diff <- length(which(abs(group_stats$group_fc)<=sim_params_without_batch$max_baseline_log2FC_between_groups))
n_genes_not_diff <- length(which(abs(group_stats$group_fc)<=sim_params$max_baseline_log2FC_between_groups))
n_genes_diff <- nrow(sim_results$simulated_datamat_filt)-n_genes_not_diff
View(group_stats)
View(group_means_filt)
pre_fc <- group_means_filt %>% dplyr::select(group_fc) %>% dplyr::mutate(Gene=rownames(group_means_filt))
View(pre_fc)
View(group_stats)
post_fc <- group_stats %>% dplyr::select(group_fc) %>% dplyr::mutate(Gene=rownames(group_stats))
fc <- dplyr::left_join(pre_fc, post_fc, by="Gene")
View(fc)
length(which(fc$group_fc.x==fc$group_fc.y))
n_genes_diff <- nrow(sim_results$simulated_datamat_filt)-n_genes_not_diff
n_genes_not_diff <- length(which(fc$group_fc.x==fc$group_fc.y))
n_genes_diff <- nrow(sim_results$simulated_datamat_filt)-n_genes_not_diff
true_diff_genes <- fc[sim_results$diff_exp_indices,]
View(true_diff_genes)
mean(abs(true_diff_genes$group_fc.y))
round(mean(abs(true_diff_genes$group_fc.y)))
round(mean(abs(true_diff_genes$group_fc.x)))
mean(abs(true_diff_genes$group_fc.x))
devtools::uninstall()
devtools::install()
q()
